# 🎵 AI编舞生成器使用指南

## ✅ 问题修复

### 1. JSON解析问题
- **问题**: API返回的内容包含markdown代码块标记（```json），导致解析失败
- **解决**: 添加了JSON清理功能，自动移除markdown标记
- **结果**: 现在可以正确解析API返回的JSON内容

### 2. 视频链接问题
- **问题**: 示例视频链接都是无效的
- **解决**: 添加了视频搜索建议功能，提供真实的搜索关键词
- **结果**: 用户可以根据建议在YouTube上找到真实的舞蹈教学视频

## 🚀 使用方法

### 1. 启动系统
```bash
streamlit run app.py
```

### 2. 设置API密钥
- 在侧边栏输入你的OpenAI API密钥
- 系统会自动设置环境变量

### 3. 上传音频文件
- 支持MP3/WAV格式
- 文件大小建议不超过100MB
- 系统会自动分析BPM和节拍

### 4. 生成编舞
- 点击"生成编舞"按钮
- 系统会显示进度条
- 生成完成后显示详细结果

## 📋 输出内容

### 基本信息
- BPM（每分钟节拍数）
- 音频时长
- 推荐舞蹈风格
- 总片段数

### 编舞总结
- 整体风格描述
- 难度评估
- 适合的舞者水平
- 练习建议

### 分段动作详情
每个8拍片段包含：
- **动作描述**: 详细的文字说明
- **参考动作**: 经典舞蹈动作名称
- **视频搜索建议**: 在YouTube上搜索的关键词
- **难度等级**: 1-5级难度评估
- **能量等级**: 1-5级能量评估
- **关键动作**: 主要动作列表
- **学习建议**: 针对性的练习指导

## 🎬 视频搜索建议

系统会为每个动作提供搜索建议，例如：
- **Harlem Shake**: 搜索 'Harlem Shake dance tutorial' 或 'Harlem Shake original'
- **Running Man**: 搜索 'Running Man dance tutorial' 或 'Running Man hip hop'
- **Freeze**: 搜索 'Freeze dance tutorial' 或 'Hip hop freeze moves'

## 💡 使用技巧

### 1. 音频质量
- 使用清晰的音频文件
- 确保节拍明显
- 避免背景噪音过多

### 2. 编舞学习
- 从基础动作开始练习
- 跟随参考视频学习
- 注意节奏感和身体协调

### 3. 练习建议
- 先慢速练习，再加快节奏
- 分解动作，逐步学习
- 反复练习，形成肌肉记忆

## 🔧 技术细节

### 系统架构
- **音频处理**: librosa库分析BPM和节拍
- **AI生成**: OpenAI GPT-3.5-turbo生成编舞
- **Web界面**: Streamlit提供用户界面
- **数据格式**: JSON格式输出，便于解析

### 支持的舞蹈风格
- Hip-Hop
- Jazz
- K-pop
- House
- Breaking
- Contemporary
- Popping
- Locking
- Waacking
- Voguing

## 📞 故障排除

### 常见问题

1. **API密钥错误**
   - 检查密钥是否正确
   - 确认账户有足够余额
   - 检查网络连接

2. **音频处理失败**
   - 确认文件格式为MP3或WAV
   - 检查文件是否损坏
   - 尝试使用其他音频文件

3. **编舞生成失败**
   - 检查API密钥设置
   - 确认网络连接正常
   - 查看控制台错误信息

### 调试方法

1. **运行测试脚本**
   ```bash
   python test_json_fix.py
   ```

2. **查看详细日志**
   - 系统会在控制台显示详细的处理信息
   - 包括API调用状态、JSON解析结果等

3. **检查输出格式**
   - 下载JSON文件查看完整结果
   - 确认所有字段都正确生成

## 🎯 未来计划

- [ ] 集成真实的舞蹈教学视频API
- [ ] 添加更多舞蹈风格和动作
- [ ] 支持用户自定义动作库
- [ ] 添加动作难度自动调节
- [ ] 集成视频播放功能
- [ ] 支持多语言界面

---

🎵 **现在你可以享受完整的AI编舞生成体验了！**
